<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCCP | Graficos</title>


    <link rel="stylesheet" href="./../css/dashboards.css">
    <link rel="stylesheet" href="./../css/estilo.css" />
    <link rel="stylesheet" href="./../css/quiz.css" />
    <link rel="shortcut icon" href="./../img/logooo.png">

    <script src="../js/sessao.js"></script>
    <script src="../js/quiz.js"></script>
    <script src="../js/quiz2.js"></script>


    <!--FONT AWESOME-->
    <script src="https://kit.fontawesome.com/9f7414eb10.js" crossorigin="anonymous"></script>
</head>

<body onload="incrementVisitCounter()">

    <div class="container-dash">
        <aside class="header-left">

            <div class="logo">
                <img src="./../img/logooo.png" alt="">
            </div>

            <nav class="header-left-nav">
                <div class="hello">
                    <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
                </div>

                <ul>
                    <li><a href="quiz.html">Quiz</a></li>
                    <li><a href="grafico.html">Graficos</a></li>
                    <li><a href="mural.html">Forum</a></li>
                    <div class="btn-logout" onclick="limparSessao()">
                        <h3>Sair</h3>
                    </div>
                </ul>
            </nav>
        </aside>

        <main class="main-content">
            <header class="main-header">
                <h1>
                    <center>Bem-vindo à Dashboard</center>
                </h1>
            </header>
            <section class="content">
                <div class="card">
                    <h3>Visitas</h3>
                    <p id="visit-count">0</p>
                </div>
                <div class="card">
                    <h3>Usuários</h3>
                    <div id="total_usuario">
                    </div>
                </div>
                <div class="card">
                    <h3>Média acertos</h3>
                    <p>7,7</p>
                </div>
            </section>

        <div class="graficos">

            <div class="info-grafic">
                <h2>Resultado do Quiz sobre o Corinthians</h2>
            
        <div class="container-grafico-sccp">
            <div class="grafico-quiz">
                <canvas id="myChart"></canvas>
            </div>
        </div>
    </div>  


        <div class="info-grafic2">
            <h2>Resultado do Quiz sobre o futebol em geral</h2>
           
        <div class="container-grafico-geral">
            <div class="grafico-geral">
                <canvas id="myChart2"></canvas>
            </div>
        </div>
    </div>  
    </div>

            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

        </main>
    </div>
</body>

</html>

<script>

        const idUsuario = sessionStorage.ID_USUARIO;
        total_usuario.innerHTML = `${idUsuario}`;
        b_usuario.innerHTML = sessionStorage.NOME_USUARIO;

        function incrementVisitCounter() {
            let visits = localStorage.getItem('visitCount');
            if (!visits) {
                visits = 0;
            }
            visits++;
            localStorage.setItem('visitCount', visits);
            document.getElementById('visit-count').innerText = visits;
        }

        // Recuperar os resultados do quiz
        const quizAcertosSCCP = sessionStorage.getItem('quiz_acertos_sccp') || 0;
        const quizErrosSCCP = sessionStorage.getItem('quiz_erros_sccp') || 0;

        const ctx = document.getElementById('myChart');

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Quiz SCCP'],
                datasets: [{
                    label: 'Acertos',
                    data: [quizAcertosSCCP],
                    backgroundColor: '#75b2f4',
                    borderColor: 'white',
                    font: {
                        family: "Poppins, sans-serif",
                        size: 20
                    }
                }, {
                    label: 'Erros',
                    data: [quizErrosSCCP],
                    backgroundColor: '#ff4736',
                    borderColor: 'white',
                    font: {
                        family: "Poppins, sans-serif",
                        size: 20
                    }
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });


        const quizAcertosGERAL = sessionStorage.getItem('quiz_acertos_geral') || 0;
        const quizErrosGERAL = sessionStorage.getItem('quiz_erros_geral') || 0;
        const ctx2 = document.getElementById('myChart2');
        new Chart(ctx2, {
            type: 'bar',
            data: {
                labels: ['Quiz Geral'],
                datasets: [{
                    label: 'Acertos',
                    data: [quizAcertosGERAL],
                    backgroundColor: '#75b2f4',
                    borderColor: 'white',
                    font: {
                        family: "Poppins, sans-serif",
                        size: 20
                    }
                }, {
                    label: 'Erros',
                    data: [quizErrosGERAL],
                    backgroundColor: '#ff4736',
                    borderColor: 'white',
                    font: {
                        family: "Poppins, sans-serif",
                        size: 20
                    }
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

</script>